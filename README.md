# D2R符文套利监控器

一个Chrome浏览器扩展，用于监控G2G和DD373网站的暗黑破坏神2重置版符文价格，计算套利利润。

## 🎯 功能特性

### 核心功能
- ✅ **实时价格监控**：每3分钟自动更新G2G和DD373的符文价格
- ✅ **利润计算**：自动计算扣除手续费后的净利润
- ✅ **智能排序**：按利润、利润率、价格等多种方式排序
- ✅ **高亮推荐**：自动高亮利润最高的套利机会
- ✅ **浏览器通知**：发现高利润机会时发送桌面通知

### 监控范围
- **符文**：23# (Mal) 到 33# (Zod) 共11个符文
- **网站**：
  - G2G.com (PC - RoTW - Ladder S13)
  - DD373.com (赛季术士君临)

### 手续费计算
```
G2G净收入 = 销售价 × (1 - 9%)
DD373总成本 = 采购价 × (1 + 5%)
利润 = G2G净收入 - DD373总成本
利润率 = 利润 ÷ DD373总成本 × 100%
```

## 🚀 安装使用

### 方法1：开发者模式加载
1. 下载本扩展的源代码
2. 打开Chrome浏览器，进入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择本扩展的文件夹

### 方法2：从Chrome Web Store安装
*（待发布）*

## 🛠 使用说明

### 基本操作
1. **点击扩展图标**打开控制面板
2. **点击"立即更新"**获取最新价格
3. **查看表格**中的利润和利润率
4. **使用过滤器**筛选符合条件的符文

### 功能说明
- **排序方式**：可按利润、利润率、符文编号等排序
- **最小利润过滤**：只显示利润超过设定值的符文
- **最小利润率过滤**：只显示利润率超过设定值的符文
- **自动刷新**：每3分钟自动更新价格（可配置）
- **数据导出**：可将价格数据导出为JSON文件

### 设置选项
- **更新频率**：1-60分钟（默认3分钟）
- **通知阈值**：当利润超过此值时发送通知（默认20 CNY）
- **GitHub同步**：可配置GitHub Token将数据同步到Gist

## 📊 界面说明

### 控制面板
```
[头部]
  - 扩展名称和状态显示
  - 最后更新时间

[控制按钮]
  - 立即更新：手动触发价格更新
  - 设置：打开设置面板
  - 导出：导出数据为JSON文件

[过滤器]
  - 排序方式选择
  - 最小利润设置
  - 最小利润率设置

[摘要信息]
  - 最佳套利符文
  - 最大利润金额
  - 平均利润率

[价格表格]
  - 符文编号和名称
  - DD373采购价（红色）
  - G2G销售价（绿色）
  - 利润（正数为绿色，负数为红色）
  - 利润率
  - 推荐标识（⭐ 或 强烈推荐）

[页脚]
  - 手续费信息显示
  - 自动刷新开关
```

## 🔧 技术架构

### 文件结构
```
d2r-rune-arbitrage-extension/
├── manifest.json          # 扩展配置文件
├── popup.html            # 弹出窗口界面
├── popup.js              # 弹出窗口逻辑
├── background.js         # 后台服务脚本
├── content.js            # 页面内容脚本
├── styles.css            # 样式文件
├── icons/                # 图标目录
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md            # 说明文档
```

### 数据流
```
1. 用户点击"立即更新"或定时触发
2. background.js 发起HTTP请求获取两个网站页面
3. content.js 在页面中提取价格数据
4. background.js 处理并存储价格数据
5. popup.js 读取数据并计算利润
6. 界面更新显示最新价格和利润
```

### 价格提取逻辑
1. **G2G网站**：
   - 访问指定分类页面
   - 解析商品列表
   - 提取符文名称和价格
   - 保留最低价

2. **DD373网站**：
   - 访问指定商品页面
   - 解析商品列表
   - 提取符文名称和价格
   - 保留最低价

## ⚙️ 配置说明

### 权限说明
- `storage`: 本地存储价格数据和设置
- `alarms`: 定时任务管理
- `notifications`: 发送浏览器通知
- `activeTab`: 获取当前标签页信息
- `host_permissions`: 访问G2G和DD373网站

### 环境要求
- Chrome浏览器 88+ 版本
- 网络连接（访问G2G和DD373）
- 无需登录目标网站账号

## 🐛 故障排除

### 常见问题
1. **价格无法更新**
   - 检查网络连接
   - 确认目标网站可访问
   - 检查浏览器控制台错误

2. **价格显示为0或null**
   - 网站页面结构可能已更新
   - 需要调整内容脚本的选择器
   - 手动访问网站确认价格显示正常

3. **扩展无法加载**
   - 确认开启了开发者模式
   - 检查manifest.json格式是否正确
   - 查看Chrome扩展错误页面

### 调试方法
1. 打开Chrome开发者工具
2. 切换到"扩展程序"标签页
3. 找到本扩展，点击"背景页"查看日志
4. 在控制台查看错误信息

## 🔄 更新日志

### v1.0.0 (2026-02-25)
- 初始版本发布
- 基础价格监控功能
- 利润计算和排序
- 自动刷新和通知

## 📝 开发计划

### 近期计划
- [ ] 添加更多符文交易网站
- [ ] 价格历史图表
- [ ] 移动端适配优化
- [ ] 多语言支持

### 长期计划
- [ ] 用户账户系统
- [ ] 自动交易提醒
- [ ] API接口服务
- [ ] 移动应用版本

## 🤝 贡献指南

欢迎提交Issue和Pull Request！

1. Fork本仓库
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开Pull Request

## 📄 许可证

本项目采用MIT许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 👥 联系方式

- 问题反馈：GitHub Issues
- 功能建议：GitHub Discussions
- 紧急联系：通过Discord联系开发者

## 🙏 致谢

感谢暗黑破坏神2重置版社区的所有交易者，是你们让这个市场充满活力！

---

**免责声明**：本工具仅用于价格监控和分析，不提供任何投资建议。虚拟物品交易存在风险，请谨慎决策。